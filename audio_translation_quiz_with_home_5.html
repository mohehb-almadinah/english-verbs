

<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="utf-8"/>
<title>ğŸ“ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„ØµÙˆØªÙŠ - Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø®Ø§Ù…Ø³Ø©</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<style>
  body { font-family: sans-serif; background-color: #f0f8ff; direction: rtl; text-align: center; padding: 30px; }
  .box { background: white; border-radius: 15px; box-shadow: 0 0 10px #ccc; padding: 20px; margin: auto; max-width: 600px; }
  button { font-size: 20px; padding: 10px 25px; margin: 10px; background-color: #1976d2; color: white; border: none; border-radius: 8px; cursor: pointer; }
  button:hover { background-color: #0d47a1; }
  .hidden { display: none; }
  audio { margin: 20px; }
  table { width: 100%; border-collapse: collapse; margin-top: 20px; }
  th, td { border: 1px solid #ccc; padding: 10px; }
</style>
</head>
<body>
<h1>ğŸ§ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„ØµÙˆØªÙŠ - Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø®Ø§Ù…Ø³Ø©</h1>
<div class="box" id="introBox">
<h2>ÙØ¶Ù„Ø§Ù‹ Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ù„Ù„Ø¨Ø¯Ø¡:</h2>
<input id="studentName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨" style="font-size:18px; padding:10px; width:80%; border-radius:8px; border:1px solid #ccc;" type="text"/>
<br/><br/>

<button onclick="startQuiz()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
</div>
<div class="box hidden" id="quizBox"><div id="timer" style="font-size:20px; font-weight:bold; color:#d32f2f; margin-bottom:15px;">â³ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: 05:00</div><div id="progressCounter" style="font-size: 18px; font-weight: bold; margin-bottom: 10px; color: #1976d2;">ğŸ“Š ØªÙ… Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„Ù‰ 0 Ù…Ù† 10</div>
<h2 id="questionTitle"></h2>
<audio controls="" id="audioPlayer"></audio>
<div id="optionsContainer"></div>
<div style="margin-top:20px;">
<div style="display: flex; flex-direction: column; align-items: center; gap: 10px;">
<button id="nextBtn" onclick="nextQuestion()">â¡ï¸ Ø§Ù„ØªØ§Ù„ÙŠ</button>
<button id="prevBtn" onclick="prevQuestion()">â¬…ï¸ Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
<button class="hidden" id="reviewBtn" onclick="reviewBeforeSubmit()" style="background-color: #388e3c; color: white;">ğŸ” Ù…Ø±Ø§Ø¬Ø¹Ø© Ù‚Ø¨Ù„ Ø§Ù„ØªØ³Ù„ÙŠÙ… Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</button>
<button class="hidden" id="submitBtn" onclick="forceSubmit()" style="background-color: #d32f2f;">ğŸ“¤ ØªØ³Ù„ÙŠÙ… Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
</div>
</div>
</div>
<div class="box hidden" id="resultBox">
<h2 id="score"></h2>
<div id="summary"></div>
</div>
<script>
let timerInterval;
let timeLeft = 300;

function startTimer() {
  const timerDisplay = document.getElementById("timer");
  timerInterval = setInterval(() => {
    if (timeLeft <= 0) {
      clearInterval(timerInterval);
      alert("Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª! ØªÙ… ØªØ³Ù„ÙŠÙ… Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§.");
      submitQuiz();
      return;
    }
    let minutes = Math.floor(timeLeft / 60);
    let seconds = timeLeft % 60;
    timerDisplay.textContent = "â³ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: " + 
      String(minutes).padStart(2, '0') + ":" + String(seconds).padStart(2, '0');
    timeLeft--;
  }, 1000);
}

let quizData = [
  ["taste", "ÙŠØªØ°ÙˆÙ‚", ["ÙŠØ­Ø§ÙˆÙ„", "ÙŠØ¹Ù…Ù„", "ÙŠØªØ°ÙˆÙ‚"]],
  ["touch", "ÙŠÙ„Ù…Ø³", ["ÙŠØ­Ø§ÙˆÙ„", "ÙŠØªØ°ÙˆÙ‚", "ÙŠÙ„Ù…Ø³"]],
  ["try", "ÙŠØ­Ø§ÙˆÙ„", ["ÙŠØ¹Ù…Ù„", "ÙŠÙ†ØªØ¸Ø±", "ÙŠØ­Ø§ÙˆÙ„"]],
  ["travel", "ÙŠØ³Ø§ÙØ±", ["ÙŠØ³Ø§ÙØ±", "ÙŠÙ„Ù…Ø³", "ÙŠØ²ÙˆØ±"]],
  ["visit", "ÙŠØ²ÙˆØ±", ["ÙŠØ²ÙˆØ±", "ÙŠØ¹Ù…Ù„", "ÙŠÙ…Ø´ÙŠ"]],
  ["wait", "ÙŠÙ†ØªØ¸Ø±", ["ÙŠÙ†ØªØ¸Ø±", "ÙŠÙ„Ù…Ø³", "ÙŠØ¹Ù…Ù„"]],
  ["walk", "ÙŠÙ…Ø´ÙŠ", ["ÙŠÙ…Ø´ÙŠ", "ÙŠØ­Ø§ÙˆÙ„", "ÙŠØºØ³Ù„"]],
  ["wash", "ÙŠØºØ³Ù„", ["ÙŠÙ„Ù…Ø³", "ÙŠØºØ³Ù„", "ÙŠØ­Ø§ÙˆÙ„"]],
  ["watch", "ÙŠØ´Ø§Ù‡Ø¯", ["ÙŠØªØ°ÙˆÙ‚", "ÙŠØ³Ø§ÙØ±", "ÙŠØ´Ø§Ù‡Ø¯"]],
  ["work", "ÙŠØ¹Ù…Ù„", ["ÙŠØ¹Ù…Ù„", "ÙŠÙ„Ù…Ø³", "ÙŠØªØ°ÙˆÙ‚"]],
];
quizData = quizData.sort(() => Math.random() - 0.5);
let current = 0;
let answers = Array(quizData.length).fill(null);
let student = "";
let usedCodes = new Set();

let validCodes = {
  "4832": "ØµØ§Ù„Ø­",
  "7261": "ÙÙŠØµÙ„",
  "5467": "Ø£Ø­Ù…Ø¯",
  "1904": "Ù…Ø­Ù…Ø¯",
  "8773": "Ù†ÙˆÙ",
  "6532": "Ø£ÙÙ†Ø§Ù†",
  "2048": "Ø«Ø§Ù…Ø±"
};

function startQuiz() {
  const name = document.getElementById("studentName").value.trim();
  if (!name) { alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… Ù„Ù„Ø¨Ø¯Ø¡."); return; }
  student = name;
  document.getElementById("introBox").classList.add("hidden");
  document.getElementById("quizBox").classList.remove("hidden");
  loadQuestion();
  startTimer();
}

function loadQuestion() {
  const questionTitle = document.getElementById("questionTitle");
  if (answers[current] === null) questionTitle.style.color = "red";
  else questionTitle.style.color = "black";
  updateProgressCounter();
  const q = quizData[current];
  document.getElementById("questionTitle").textContent = "Ø§Ù„Ø³Ø¤Ø§Ù„ " + (current + 1) + " Ù…Ù† " + quizData.length + ": Ù…Ø§ ØªØ±Ø¬Ù…Ø© Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø³Ù…ÙˆØ¹Ø©ØŸ";
  document.getElementById("audioPlayer").src = "audio_5/" + q[0] + ".mp3";
  const container = document.getElementById("optionsContainer");
  container.innerHTML = "";
  q[2].forEach(option => {
    const btn = document.createElement("button");
    btn.textContent = option;
    btn.onclick = () => { answers[current] = option; loadQuestion(); };
    if (answers[current] === option) btn.style.border = "3px solid black";
    container.appendChild(btn);
  });
  document.getElementById("prevBtn").style.display = current > 0 ? "inline-block" : "none";
  document.getElementById("nextBtn").style.display = current < quizData.length - 1 ? "inline-block" : "none";
  document.getElementById("submitBtn").classList.toggle("hidden", current !== quizData.length - 1);
  document.getElementById("reviewBtn").classList.toggle("hidden", current !== quizData.length - 1);
}

function nextQuestion() { if (current < quizData.length - 1) { current++; loadQuestion(); } }
function prevQuestion() { if (current > 0) { current--; loadQuestion(); } }

function submitQuiz() {
  document.getElementById("quizBox").classList.add("hidden");
  const resultBox = document.getElementById("resultBox");
  const scoreElem = document.getElementById("score");
  let score = 0;
  let summary = "<table><tr><th>Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„</th><th>Ø§Ù„Ù…Ù‚Ø·Ø¹ Ø§Ù„ØµÙˆØªÙŠ</th><th>Ø¥Ø¬Ø§Ø¨ØªÙƒ</th><th>Ø§Ù„Ù†ØªÙŠØ¬Ø©</th></tr>";
  quizData.forEach((q, i) => {
    const correct = q[1];
    const userAnswer = answers[i];
    const isCorrect = userAnswer === correct;
    if (isCorrect) score++;
    summary += '<tr><td>' + (i + 1) + '</td><td>' + '<audio controls src=\"audio_5/' + q[0] + '.mp3\"></audio>' + '</td><td>' + userAnswer + '</td><td style="color:' + (isCorrect ? 'green' : 'red') + '">' +
               (isCorrect ? 'âœ… ØµØ­ÙŠØ­Ø©' : 'âŒ Ø®Ø§Ø·Ø¦Ø© (Ø§Ù„ØµØ­ÙŠØ­: ' + correct + ')') + '</td></tr>';
  });
  summary += "</table>";
  scoreElem.innerHTML = "<strong>" + student + "</strong>ØŒ Ù†ØªÙŠØ¬ØªÙƒ: <strong>" + score + " Ù…Ù† " + quizData.length + "</strong><br>" +
    (score >= 8 ? '<span style="color:green; font-size: 20px;">Ø£Ø­Ø³Ù†Øª! ğŸŒŸ Ø§Ø³ØªÙ…Ø± ÙˆÙÙ‚Ùƒ Ø§Ù„Ù„Ù‡</span><br><button onclick="generateCertificate()" style="margin-top:20px; background-color:#4caf50;">ğŸ“„ ØªØ­Ù…ÙŠÙ„ Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ù†Ø¬Ø§Ø­</button>' : '<span style="color:red; font-size: 20px;">ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¯Ø±Ø³.</span>');
  document.getElementById("summary").innerHTML = summary;
  resultBox.classList.remove("hidden");
}

function reviewBeforeSubmit() {
  if (answers.includes(null)) {
    alert("Ø¨Ø¹Ø¶ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ù„Ù… ÙŠØªÙ… Ø­Ù„Ù‡Ø§ØŒ ÙˆØªÙ… ØªÙ…ÙŠÙŠØ²Ù‡Ø§ Ø¨Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø­Ù…Ø±.");
    const unansweredIndex = answers.findIndex(ans => ans === null);
    current = unansweredIndex;
    loadQuestion();
    return;
  }
  submitQuiz();
}

function forceSubmit() {
  clearInterval(timerInterval);
  submitQuiz();
}

function updateProgressCounter() {
  const answered = answers.filter(ans => ans !== null).length;
  const total = quizData.length;
  const counter = document.getElementById("progressCounter");
  counter.textContent = "ğŸ“Š ØªÙ… Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„Ù‰ " + answered + " Ù…Ù† " + total;
}

let certificateBtn;
function generateCertificate() {
  const certificateWindow = window.open("", "_blank");
  certificateWindow.document.write(`
    <html lang="ar">
    <head>
      <meta charset="UTF-8">
      <title>Ø´Ù‡Ø§Ø¯Ø© Ù†Ø¬Ø§Ø­</title>
      <style>
        @media print {
          @page {
            size: A4 landscape;
            margin: 0;
          }
          body {
            margin: 0;
          }
        }
        body {
          font-family: 'Arial', sans-serif;
          direction: rtl;
          text-align: center;
          background-color: #f0f8e9;
          padding: 80px;
        }
        .certificate-box {
          background-color: #ffffff;
          border: 10px solid #4caf50;
          padding: 40px;
          border-radius: 20px;
          width: 100%;
          box-sizing: border-box;
          box-shadow: 0 0 30px rgba(0, 0, 0, 0.2);
        }
        h1 {
          color: #2e7d32;
          font-size: 48px;
          margin-bottom: 20px;
        }
        h2 {
          color: #1976d2;
          font-size: 36px;
          margin: 20px 0;
        }
        p {
          font-size: 24px;
          margin: 10px 0;
        }
        .footer {
          margin-top: 60px;
          font-size: 18px;
          color: #555;
        }
      </style>
    </head>
    <body>
      <div class="certificate-box">
        <h1>ğŸ“Ø´Ù‡Ø§Ø¯Ø© Ù†Ø¬Ø§Ø­ğŸ“</h1>
        <p>ØªØ´Ù‡Ø¯ Ø¨ÙˆØ§Ø¨Ø© ØªØ¹Ù„Ù… Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø£Ù† Ø§Ù„Ø·Ø§Ù„Ø¨/ Ù€Ù‡</p>
        <h2>${student}</h2>
        <p>Ù‚Ø¯ Ø§Ø¬ØªØ§Ø² Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„ØµÙˆØªÙŠ - Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø£ÙØ¹Ø§Ù„ Ø§Ù„Ø®Ø§Ù…Ø³Ø© Ø¨Ù†Ø¬Ø§Ø­</p>
        <p>ğŸ“˜ÙˆÙ†ØªÙ…Ù‰ Ù„Ù‡/ Ù€Ù‡Ø§ Ø¯ÙˆØ§Ù… Ø§Ù„ØªÙˆÙÙŠÙ‚ ÙˆØ§Ù„Ù†Ø¬Ø§Ø­ğŸ“˜ </p>
        <p class="footer" style="font-weight:bold;">Ø¯. Ù…Ø­Ù…Ø¯ Ø§Ù„Ø¹ÙˆÙÙŠ</p>
        <p class="footer">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©: ${(new Date()).toLocaleDateString('en-GB')}</p>
      </div>
    </body>
    </html>
  `);
  certificateWindow.document.close();
  certificateWindow.print();
}

</script>
<div style="margin-top: 40px;">
<button onclick="location.href='index.html'" style="background-color:#9e9e9e;">ğŸ  Ø§Ù„Ø±Ø¬ÙˆØ¹ Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
</div>
</body>
</html>
